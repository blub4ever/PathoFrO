<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
>

<h:head>
    <title><h:outputFormat
            value="#{msg['dialog.archiveTask.headline']}"/></title>
    <h:outputStylesheet name="style.css" value="style.css" library="css"/>
    <h:outputStylesheet name="specificStyle.css" value="specificStyle.css"
                        library="css"/>
    <h:outputScript library="scripts" name="commonFunctions.js"/>
</h:head>

<h:body styleClass="histoDialogStyle">

    <h:form id="dialogContent">

        <div class="dialogHeader">
            <h:panelGrid style="width:100%;" columns="2"
                         styleClass="defaultHistoTable">
                <h:outputLabel value="#{msg['dialog.archiveTask.headline']}"/>
                <p:commandLink title="#{msg['general.close']}" style="float:right;"
                               onclick="$('#dialogContent\\:closeBtn').click();return false;">
                    <i class="fa fa-fw fa-times"/>
                </p:commandLink>
            </h:panelGrid>
        </div>

        <div class="dialogContent">

            <h:panelGrid columns="2" columnClasses="columnWidthPercent50 columnTop, columnWidthPercent50 columnTop"
                         styleClass="defaultHistoHiddenTableContainer" style="width: 100%">

                <!-- left column -->
                <h:panelGrid columns="1" styleClass="defaultHistoHiddenTableContainer" style="width: 100%;">

                    <!-- staining -->
                    <h:panelGrid columns="1" styleClass="defaultHistoSeperatorTable">
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.staining.text']}"/>
                    </h:panelGrid>

                    <h:panelGrid columns="2" styleClass="defaultHistoTable" style="margin-left: 10px;"
                                 columnClasses="columnWidth250">

                        <!-- stainingphase -->
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.staining.phase.text']} "/>
                        <h:panelGroup id="stainingDate">
                            <i class="fa fa-fw #{archiveTaskDialog.status.stainingStatus.completed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                            <h:outputFormat style="margin-left: 5px"
                                            value="#{archiveTaskDialog.status.stainingStatus.dateOfCompletion}"
                                            rendered="#{archiveTaskDialog.status.stainingStatus.completed}">
                                <f:converter converterId="instantDateTimeConverter"/>
                                <f:attribute name="pattern" value="dd.MM.yyyy HH:mm:ss"/>
                            </h:outputFormat>

                            <p:tooltip for="stainingDate">
                                <h:outputLabel value="#{msg['dialog.archiveTask.status.staining.phase.completed']} "
                                               rendered="#{archiveTaskDialog.status.stainingStatus.completed}"/>

                                <h:outputLabel value="#{msg['dialog.archiveTask.status.staining.phase.notCompleted']}"
                                               rendered="#{!archiveTaskDialog.status.stainingStatus.completed}"/>
                            </p:tooltip>
                        </h:panelGroup>

                        <!-- slide status -->
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.staining.slides.text']}"/>
                        <h:panelGroup id="stainingCompleted">
                            <i class="fa fa-fw #{archiveTaskDialog.taskStatus.stainingCompleted ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                            <p:tooltip for="stainingCompleted">
                                <h:outputText
                                        value="#{msg['dialog.archiveTask.status.staining.slides.completed']}"
                                        rendered="#{archiveTaskDialog.status.stainingStatus.allSlidesCompleted}"/>
                                <h:outputLabel
                                        value="#{msg['dialog.archiveTask.status.staining.slides.notCompleted']}"
                                        rendered="#{!archiveTaskDialog.status.stainingStatus.allSlidesCompleted}"/>
                            </p:tooltip>
                        </h:panelGroup>
                    </h:panelGrid>

                    <!-- slides -->
                    <h:panelGrid styleClass="defaultHistoTable" style="margin-left: 10px;">
                        <p:accordionPanel activeIndex="-1"
                                          styleClass="contentAccordionPannel" style="width:450px">

                            <p:tab title="#{msg['dialog.archiveTask.status.staining.details.text']}">
                                <p:dataTable styleClass="defaultHistoDataTable" style="width: auto"
                                             value="#{archiveTaskDialog.status.stainingStatus.slides}" var="slide">
                                    <!-- name -->
                                    <p:column
                                            headerText="#{msg['dialog.archiveTask.status.staining.details.list.name']}">
                                        <h:outputText value="#{slide.name}"/>
                                    </p:column>

                                    <p:column style="width:120px"
                                              styleClass="centerChildElements centerHeaderChildElements"
                                              headerText="#{msg['dialog.archiveTask.status.staining.details.list.status']}">
                                        <h:panelGroup id="stainingStatus">
                                            <i class="fa fa-fw #{slide.completed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                                            <h:outputFormat style="margin-left: 5px" rendered="#{slide.completed}"
                                                            value="#{slide.dateOfCompletion}">
                                                <f:convertDateTime type="date"/>
                                            </h:outputFormat>

                                            <p:tooltip for="stainingStatus">
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.staining.details.list.completed']} "
                                                        rendered="#{slide.completed}"/>
                                                <h:outputLabel
                                                        value="#{msg['dialog.archiveTask.status.staining.details.list.notCompleted']}"
                                                        rendered="#{!slide.completed}"/>
                                            </p:tooltip>
                                        </h:panelGroup>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:accordionPanel>
                    </h:panelGrid>

                    <!-- diangoses -->
                    <h:panelGrid columns="1" styleClass="defaultHistoSeperatorTable">
                        <p:separator/>
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses.text']}"/>
                    </h:panelGrid>

                    <h:panelGrid columns="2" styleClass="defaultHistoTable" style="margin-left: 10px;"
                                 columnClasses="columnWidth250">
                        <!-- diagnosis phase -->
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses.phase.text']} "/>
                        <h:panelGroup id="diagnosisDate">
                            <i class="fa fa-fw #{archiveTaskDialog.status.diagnosisStatus.completed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                            <h:outputFormat style="margin-left: 5px"
                                            value="#{archiveTaskDialog.status.diagnosisStatus.dateOfCompletion}"
                                            rendered="#{archiveTaskDialog.status.diagnosisStatus.completed}">
                                <f:converter converterId="instantDateTimeConverter"/>
                                <f:attribute name="pattern" value="dd.MM.yyyy HH:mm:ss"/>
                            </h:outputFormat>
                            <p:tooltip for="diagnosisDate">
                                <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses.phase.completed']}"
                                               rendered="#{archiveTaskDialog.taskStatus.diagnosisPhaseCompleted}"/>
                                <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses.phase.notCompleted']}"
                                               rendered="#{!archiveTaskDialog.taskStatus.diagnosisPhaseCompleted}"/>
                            </p:tooltip>
                        </h:panelGroup>

                        <!-- diagnosis correct -->
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses.status.text']}"/>
                        <h:panelGroup id="diagnosisCompleted">
                            <i class="fa fa-fw #{archiveTaskDialog.status.diagnosisStatus.valid ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                            <p:tooltip for="diagnosisCompleted">
                                <h:outputText value="#{msg['dialog.archiveTask.status.diagnoses.status.completed']}"
                                              rendered="#{archiveTaskDialog.status.diagnosisStatus.valid }"/>
                                <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses.status.notCompleted']}"
                                               rendered="#{!archiveTaskDialog.status.diagnosisStatus.valid }"/>
                            </p:tooltip>
                        </h:panelGroup>
                    </h:panelGrid>

                    <!-- diagnoses -->
                    <h:panelGrid styleClass="defaultHistoTable" style="margin-left: 10px;">
                        <p:accordionPanel activeIndex="-1"
                                          styleClass="contentAccordionPannel" style="width:450px">
                            <p:tab title="#{msg['dialog.archiveTask.status.diagnoses.details.text']}">
                                <p:dataTable styleClass="defaultHistoDataTable"
                                             value="#{archiveTaskDialog.status.diagnosisStatus.revisions}"
                                             var="diagnosis">
                                    <!-- name -->
                                    <p:column
                                            headerText="#{msg['dialog.archiveTask.status.diagnoses.details.list.name']}">
                                        <h:outputText value="#{diagnosis.name}"/>
                                    </p:column>

                                    <!-- completed -->
                                    <p:column styleClass="centerChildElements centerHeaderChildElements"
                                              headerText="#{msg['dialog.archiveTask.status.diagnoses.details.list.completed.text']}">
                                        <h:panelGroup id="diangosisC">
                                            <i class="fa fa-fw #{diagnosis.completed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                                            <h:outputFormat style="margin-left: 5px"
                                                            value="#{diagnosis.dateOfCompletion}"
                                                            rendered="#{diagnosis.completed}">
                                                <f:converter converterId="instantDateTimeConverter"/>
                                                <f:attribute name="pattern" value="dd.MM.yyyy HH:mm:ss"/>
                                            </h:outputFormat>
                                            <p:tooltip for="diangosisC">
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.completed.completed']}"
                                                        rendered="#{diagnosis.completed}"/>
                                                <h:outputLabel
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.completed.notCompleted']}"
                                                        rendered="#{!diagnosis.completed and !diagnosis.noNotification}"/>
                                            </p:tooltip>
                                        </h:panelGroup>
                                    </p:column>

                                    <!-- signature -->
                                    <p:column styleClass="centerChildElements centerHeaderChildElements"
                                              headerText="#{msg['dialog.archiveTask.status.diagnoses.details.list.signature.text']}">
                                        <h:panelGroup id="diangosisS">
                                            <i class="fa fa-fw #{diagnosis.signed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                                            <p:tooltip for="diangosisS">
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.signature.completed']}"
                                                        rendered="#{diagnosis.signed}"/>
                                                <h:outputLabel
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.signature.notCompleted']}"
                                                        rendered="#{!diagnosis.signed and !diagnosis.noNotification}"/>
                                            </p:tooltip>
                                        </h:panelGroup>
                                    </p:column>

                                    <!-- notification performed -->
                                    <p:column styleClass="centerChildElements centerHeaderChildElements"
                                              headerText="#{msg['dialog.archiveTask.status.diagnoses.details.list.notification.text']}">
                                        <h:panelGroup id="diangosisNotification">
                                            <h:panelGroup rendered="#{diagnosis.noNotification}">
                                                <i class="fa fa-fw fa-check-circle'}"/>
                                            </h:panelGroup>

                                            <h:panelGroup rendered="#{!diagnosis.noNotification}">
                                                <i class="fa fa-fw #{diagnosis.notificationPerformed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                                                <h:outputFormat style="margin-left: 5px"
                                                                value="#{diagnosis.dateOfNotification}"
                                                                rendered="#{diagnosis.notificationPerformed}">
                                                    <f:converter converterId="instantDateTimeConverter"/>
                                                    <f:attribute name="pattern" value="dd.MM.yyyy HH:mm:ss"/>
                                                </h:outputFormat>
                                            </h:panelGroup>

                                            <p:tooltip for="diangosisNotification">
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.notification.completed']}"
                                                        rendered="#{diagnosis.notificationPerformed and !diagnosis.noNotification}"/>
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.status.list.ignore.true']}"
                                                        rendered="#{diagnosis.notificationPerformed and !diagnosis.noNotification}"/>
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.notification.notCompleted']}"
                                                        rendered="#{diagnosis.noNotification}"/>
                                            </p:tooltip>
                                        </h:panelGroup>
                                    </p:column>

                                </p:dataTable>
                            </p:tab>
                        </p:accordionPanel>
                    </h:panelGrid>

                    <!-- notification -->
                    <h:panelGrid columns="1" styleClass="defaultHistoSeperatorTable">
                        <p:separator/>
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.notification.text']}"/>
                    </h:panelGrid>

                    <h:panelGrid columns="2" styleClass="defaultHistoTable" style="margin-left: 10px;"
                                 columnClasses="columnWidth250">

                        <!-- notification phase -->
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.notification.phase.text']} "/>
                        <h:panelGroup id="notificationDate">
                            <i class="fa fa-fw #{archiveTaskDialog.status.notificationStatus.completed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                            <p:tooltip for="notificationDate">
                                <h:outputLabel value="#{msg['dialog.archiveTask.status.notification.phase.completed']}"
                                               rendered="#{archiveTaskDialog.status.notificationStatus.completed}"/>
                                <h:outputLabel
                                        value="#{msg['dialog.archiveTask.status.notification.phase.notCompleted']}"
                                        rendered="#{!archiveTaskDialog.status.notificationStatus.completed}"/>
                            </p:tooltip>
                        </h:panelGroup>
                    </h:panelGrid>

                    <!-- notification data -->
                    <h:panelGrid styleClass="defaultHistoTable" style="margin-left: 10px;">
                        <p:accordionPanel activeIndex="-1"
                                          styleClass="contentAccordionPannel" style="width:450px">
                            <p:tab title="#{msg['dialog.archiveTask.status.diagnoses.details.text']}">
                                <!-- contacts -->
                                <p:dataTable var="reportIntent" scrollable="true" scrollHeight="90"
                                             style="width:450px" styleClass="defaultHistoDataTable"
                                             value="#{archiveTaskDialog.status.notificationStatus.notification.reportIntentBearer}">

                                    <!-- name -->
                                    <p:column style="width:auto">
                                        <f:facet name="header">
                                            <h:outputLabel value="#{msg['body.receiptlog.contact.name']}"/>
                                        </f:facet>

                                        <h:outputLabel value="#{reportIntent.person.getFullName()}" id="test123"/>

                                    </p:column>
                                    <p:column>
                                        <!--<p:commandLink-->
                                                <!--styleClass="contactInfoOverplayTrigger"-->
                                                <!--icon="pi pi-search"-->
                                                <!--actionListener="#{receiptLogView.setSelectedReportIntentStatus(reportIntent)}"-->
                                                <!--partialSubmit="true"-->
                                                <!--process="@this"-->
                                                <!--update="contentForm:contactInfoOverlayPanel"-->
                                                <!--oncomplete="commonFunctions.showOverlayPanel('contactInfoOverlayPanel', '#{component.clientId}');">-->
                                            <i class="fa fa-info-circle"/>
                                        <!--</p:commandLink>-->
                                    </p:column>
                                    <p:column>
                                        <h:panelGroup id="notficationp">
                                            <i class="fa fa-fw #{reportIntent.completed ? 'fa-check-circle icon-green' : 'fa-times-circle icon-red'}"/>
                                            <p:tooltip for="notficationp">
                                                <h:outputText
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.signature.completed']}"
                                                        rendered="#{reportIntent.completed}"/>
                                                <h:outputLabel
                                                        value="#{msg['dialog.archiveTask.status.diagnoses.details.list.signature.notCompleted']}"
                                                        rendered="#{!reportIntent.completed}"/>
                                            </p:tooltip>
                                        </h:panelGroup>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:accordionPanel>

                        <!--&lt;!&ndash; overlay for contact notifications &ndash;&gt;-->
                        <!--<p:overlayPanel widgetVar="contactInfoOverlayPanel" hideEvent="null" showEvent="null"-->
                        <!--dismissable="false" id="contactInfoOverlayPanel" styleClass="histoOverlayPanel">-->

                        <!--<c:forEach items="#{receiptLogView.selectedReportIntentStatus.diagnosisBearers}"-->
                        <!--var="diagnosisBearer">-->

                        <!--<h:panelGrid columns="1" style="width:400px !important;" styleClass="defaultHistoTable">-->

                        <!--<h:panelGroup layout="block" style="widht:100%;" styleClass="histo_header">-->
                        <!--<h:outputText value="#{diagnosisBearer.diagnosisName}"/>-->
                        <!--</h:panelGroup>-->

                        <!--<c:forEach items="#{diagnosisBearer.reportIntentNotificationBearers}"-->
                        <!--var="notificationBearer">-->

                        <!--<h:panelGrid columns="5" styleClass="defaultHistoHiddenTableContainer"-->
                        <!--style="width:98% !important;margin-left: 10px"-->
                        <!--columnClasses="columnWidth25,columnWidth75,columnWidth75,columnWidth75,">-->

                        <!--&lt;!&ndash; type icon &ndash;&gt;-->
                        <!--<h:panelGroup>-->
                        <!--<ui:fragment-->
                        <!--rendered="#{notificationBearer.type eq 'EMAIL'}">-->
                        <!--<i class="fa fa-envelope icon-grey"/>-->
                        <!--</ui:fragment>-->

                        <!--<ui:fragment rendered="#{notificationBearer.type eq 'FAX'}">-->
                        <!--<i class="fa fa-fax icon-grey"/>-->
                        <!--</ui:fragment>-->

                        <!--<ui:fragment-->
                        <!--rendered="#{notificationBearer.type eq 'LETTER'}">-->
                        <!--<i class="fa fa-pencil-square-o icon-grey"/>-->
                        <!--</ui:fragment>-->

                        <!--<ui:fragment-->
                        <!--rendered="#{notificationBearer.type eq 'PHONE'}">-->
                        <!--<i class="fa fa-phone icon-grey"/>-->
                        <!--</ui:fragment>-->

                        <!--<ui:fragment-->
                        <!--rendered="#{notificationBearer.type eq 'PRINT'}">-->
                        <!--<i class="fa fa-print icon-grey"/>-->
                        <!--</ui:fragment>-->
                        <!--</h:panelGroup>-->

                        <!--&lt;!&ndash; attempts &ndash;&gt;-->
                        <!--<h:outputFormat value="#{msg['body.receiptlog.contact.overview.attempts']}">-->
                        <!--<f:param value="#{notificationBearer.attempts}"/>-->
                        <!--</h:outputFormat>-->

                        <!--&lt;!&ndash; successes &ndash;&gt;-->
                        <!--<h:outputFormat value="#{msg['body.receiptlog.contact.overview.success']}">-->
                        <!--<f:param value="#{notificationBearer.successes}"/>-->
                        <!--</h:outputFormat>-->

                        <!--&lt;!&ndash; failedAttempts &ndash;&gt;-->
                        <!--<h:outputFormat-->
                        <!--value="#{msg['body.receiptlog.contact.overview.failedAttampts']}">-->
                        <!--<f:param value="#{notificationBearer.failedAttempts}"/>-->
                        <!--</h:outputFormat>-->

                        <!--&lt;!&ndash; performed &ndash;&gt;-->
                        <!--<ui:fragment rendered="#{notificationBearer.attempts != 0}">-->
                        <!--<h:panelGroup>-->
                        <!--<h:outputLabel-->
                        <!--value="#{msg['body.receiptlog.contact.overview.performed']}"/>-->
                        <!--<i class="fa fa-fw #{notificationBearer.success ? 'fa-check-circle icon-green' :'fa-exclamation-triangle icon-red'}"-->
                        <!--title="#{msg['body.statiningView.idManuallyAltered']}"/>-->
                        <!--</h:panelGroup>-->
                        <!--</ui:fragment>-->

                        <!--<ui:fragment rendered="#{notificationBearer.attempts == 0}">-->
                        <!--<h:panelGroup>-->
                        <!--<h:outputLabel-->
                        <!--value="#{msg['body.receiptlog.contact.overview.performed']}"/>-->
                        <!--<i class="fa fa-fw fa-minus"/>-->
                        <!--</h:panelGroup>-->
                        <!--</ui:fragment>-->

                        <!--</h:panelGrid>-->

                        <!--</c:forEach>-->
                        <!--</h:panelGrid>-->
                        <!--</c:forEach>-->

                        <!--</p:overlayPanel>-->
                    </h:panelGrid>


                </h:panelGrid>

                <!-- right column -->
                <h:panelGrid columns="1" styleClass="defaultHistoHiddenTableContainer">


                    <!-- councils -->
                    <h:panelGrid columns="1" styleClass="defaultHistoSeperatorTable">
                        <p:separator/>
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses']}"/>
                    </h:panelGrid>

                    <!-- miscellaneous -->
                    <h:panelGrid columns="1" styleClass="defaultHistoSeperatorTable">
                        <p:separator/>
                        <h:outputLabel value="#{msg['dialog.archiveTask.status.diagnoses']}"/>
                    </h:panelGrid>
                </h:panelGrid>
            </h:panelGrid>
        </div>

        <div class="buttonContainer">
            <h:panelGrid columns="2">

                <h:panelGrid columns="1" styleClass="left">
                </h:panelGrid>

                <h:panelGrid columns="2" styleClass="right">
                    <!-- Save button -->
                    <p:commandButton
                            value="#{msg['dialog.archiveTask.button.archive']}"
                            icon="fa fa-archive">
                        <f:actionListener
                                binding="#{archiveTaskDialog.archiveTask()}"/>
                        <f:actionListener
                                binding="#{archiveTaskDialog.hideDialog()}"/>
                    </p:commandButton>

                    <!-- Close button -->
                    <p:commandButton value="#{msg['general.abort']}" id="closeBtn"
                                     icon="fa fa-times-circle" actionListener="#{archiveTaskDialog.hideDialog()}">
                    </p:commandButton>
                </h:panelGrid>
            </h:panelGrid>
        </div>


    </h:form>
</h:body>
</html>