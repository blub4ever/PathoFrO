<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:histo="http://java.sun.com/jsf/composite/components"
                xmlns:pe="http://primefaces.org/ui/extensions">

    <!-- importing enum for switch -->
    <p:importEnum
            type="com.patho.main.model.patient.NotificationStatus"
            var="notificationStatus" allSuffix="ALL_ENUM_VALUES"/>

    <p:outputPanel styleClass="headerPannel">
        <h:outputLabel
                value="#{msg['dialog.notificationDialog.general.headline']}"/>
    </p:outputPanel>

    <p:outputPanel styleClass="bodyPannel">

        <!-- diagnoses -->
        <h:panelGrid columns="2" styleClass="defaultHistoTable"
                     columnClasses="columnWidth150 columnTop,">

            <!-- Notifications -->
            <h:outputLabel
                    value="#{msg['dialog.notificationDialog.general.diagnosis']}"
                    styleClass="bigFont"/>

            <h:panelGroup>
                <p:dataTable var="diangosis" id="diangosisList"
                             scrollHeight="100" styleClass="defaultHistoDataTable"
                             scrollable="true" selectionMode="single"
                             rowKey="#{diangosis.diagnosisRevision.id}"
                             selection="#{notificationDialog.generalTab.selectDiagnosisRevision}"
                             value="#{notificationDialog.generalTab.diagnosisRevisions}">
                    <!-- Name -->
                    <p:column
                            headerText="#{msg['dialog.notificationDialog.general.data.name']}"
                            style="width:auto">
                        <h:outputText value="#{diangosis.diagnosisRevision.name}"/>
                    </p:column>

                    <!-- info -->
                    <p:column style="width: 5%" styleClass="centerChildElements centerHeaderChildElements">
                        <f:facet name="header">
                            <i class="fa fa-info-circle"/>
                        </f:facet>
                        <p:commandLink
                                styleClass="diagnosisOverlayPanelyTrigger"
                                icon="pi pi-search"
                                actionListener="#{notificationDialog.generalTab.setViewDiagnosisRevisionDetails(diangosis)}"
                                partialSubmit="true"
                                process="@this"
                                update="adminForm:diagnosisOverlayPanel"
                                oncomplete="commonFunctions.showOverlayPanel('diagnosisOverlayPanel', '#{component.clientId}');">
                            <i class="fa fa-info-circle"/>
                        </p:commandLink>
                    </p:column>

                    <!-- pending -->
                    <p:column style="width:10%" styleClass="centerChildElements"
                              headerText="#{msg['dialog.notificationDialog.general.data.status.text']}">
                        <pe:switch value="#{diangosis.diagnosisRevision.notificationStatus}">
                            <pe:case value="#{notificationStatus.NOT_APPROVED}">
                                <i class="fa fa-fw fa-volume-off icon-red"
                                   title="#{msg['dialog.notificationDialog.general.data.status.notApproved']}"/>
                            </pe:case>
                            <pe:case value="#{notificationStatus.NOTIFICATION_PENDING}">
                                <i class="fa fa-fw fa-volume-up icon-orange"
                                   title="#{msg['dialog.notificationDialog.general.data.status.pending']}"/>
                            </pe:case>
                            <pe:case value="#{notificationStatus.NO_NOTFICATION}">
                                <i class="fa fa-fw fa-circle icon-red"
                                   title="#{msg['dialog.notificationDialog.general.data.status.none']}"/>
                            </pe:case>
                            <pe:case value="#{notificationStatus.NOTIFICATION_COMPLETED}">
                                <i class="fa fa-fw fa-check-circle icon-green"
                                   title="#{msg['dialog.notificationDialog.general.data.status.completed']}"/>
                            </pe:case>
                            <pe:defaultCase>
                                <i class="fa fa-question icon-grey"/>
                            </pe:defaultCase>
                        </pe:switch>
                    </p:column>

                    <!-- performed -->
                    <p:column style="width:20%"
                              headerText="#{msg['dialog.notificationDialog.general.data.performed']}">

                        <h:outputText value="#{diangosis.diagnosisRevision.notificationDate}"
                                      rendered="#{diangosis.diagnosisRevision.notified}">
                            <f:converter converterId="instantDateTimeConverter"/>
                            <f:attribute name="pattern" value="dd.MM.yyyy HH:mm:ss"/>
                        </h:outputText>

                    </p:column>

                    <p:ajax event="rowSelect" process="@form" update="@form"
                            listener="#{notificationDialog.generalTab.onDiagnosisSelect()}"/>
                </p:dataTable>

                <script type="text/javascript">
                    commonFunctions.addGlobalHideOverlayPanelOnMouseClickHandler('diagnosisOverlayPanel')
                    commonFunctions.addShowDialogOnMouseEnter(".diagnosisOverlayPanelyTrigger", "diagnosisOverlayPanel")
                </script>

                <!-- overlay for contact notifications -->
                <p:overlayPanel widgetVar="diagnosisOverlayPanel" hideEvent="null" showEvent="null"
                                style="width: 500px;"
                                dismissable="false" id="diagnosisOverlayPanel" styleClass="histoOverlayPanel">
                    <p:dataTable value="#{notificationDialog.generalTab.viewDiagnosisRevisionDetails.reportIntents}"
                                 var="reportIntent" styleClass="defaultHistoDataTable">
                        <!-- name -->
                        <p:column headerText="#{msg['dialog.notificationDialog.general.overlay.personName']}"
                                  style="width: auto">
                            <h:outputLabel value="#{reportIntent.reportIntent.person.fullName}"/>
                        </p:column>

                        <!-- mail status -->
                        <p:column style="width:10%" styleClass="centerChildElements centerHeaderChildElements">
                            <f:facet name="header">
                                <i class="fa fa-envelope icon-grey"/>
                            </f:facet>
                            <h:panelGroup rendered="#{reportIntent.isMailRecord()}">
                                <i class="fa fa-fw fa-envelope #{reportIntent.mailPerformed ? 'icon-green' : ''}"
                                   title="#{reportIntent.mailPerformed ? msg['dialog.notificationDialog.general.overlay.performed'] : msg['dialog.notificationDialog.general.overlay.pending']}"/>
                            </h:panelGroup>
                        </p:column>

                        <!-- fax status -->
                        <p:column style="width:10%" styleClass="centerChildElements centerHeaderChildElements">
                            <f:facet name="header">
                                <i class="fa fa-fax icon-grey"/>
                            </f:facet>
                            <h:panelGroup rendered="#{reportIntent.isFaxRecord()}">
                                <i class="fa fa-fax #{reportIntent.faxPerformed ? 'icon-green' : ''}"
                                   title="#{reportIntent.faxPerformed ? msg['dialog.notificationDialog.general.overlay.performed'] : msg['dialog.notificationDialog.general.overlay.pending']}"/>
                            </h:panelGroup>
                        </p:column>

                        <!-- letter -->
                        <p:column style="width:10%" styleClass="centerChildElements centerHeaderChildElements">
                            <f:facet name="header">
                                <i class="fa fa-pencil-square-o icon-grey"/>
                            </f:facet>
                            <h:panelGroup rendered="#{reportIntent.isLetterRecord()}">
                                <i class="fa fa-pencil-square-o #{reportIntent.letterPerformed ? 'icon-green' : ''}"
                                   title="#{reportIntent.letterPerformed ? msg['dialog.notificationDialog.general.overlay.performed'] : msg['dialog.notificationDialog.general.overlay.pending']}"/>
                            </h:panelGroup>
                        </p:column>

                        <!-- phone -->
                        <p:column style="width:10%" styleClass="centerChildElements centerHeaderChildElements">
                            <f:facet name="header">
                                <i class="fa fa-phone icon-grey"/>
                            </f:facet>
                            <h:panelGroup rendered="#{reportIntent.isPhoneRecord()}">
                                <i class="fa fa-phone #{reportIntent.letterPerformed ? 'icon-green' : ''}"
                                   title="#{reportIntent.letterPerformed ? msg['dialog.notificationDialog.general.overlay.performed'] : msg['dialog.notificationDialog.general.overlay.pending']}"/>
                            </h:panelGroup>
                        </p:column>
                    </p:dataTable>
                </p:overlayPanel>

            </h:panelGroup>

            <h:outputLabel value=" "/>
            <!-- diagnosis not approved warning -->
            <h:panelGroup>
                <h:outputLabel styleClass="icon-red bigFont"
                               value="#{msg['dialog.notificationDialog.general.warning.notApproved']}"
                               rendered="#{notificationDialog.generalTab.selectedDiagnosisNotApproved}"/>
            </h:panelGroup>
        </h:panelGrid>

        <!-- Separator -->
        <h:panelGrid columns="1" styleClass="defaultHistoSeperatorTable">
            <p:separator/>
            <h:outputLabel
                    value="#{msg['dialog.notificationDialog.general.additionalPrints.headline']}"/>
        </h:panelGrid>

        <!-- additional prints -->
        <h:panelGrid columns="2" styleClass="defaultHistoTable"
                     columnClasses="columnWidth150,">

            <!-- Use additional prints-->
            <h:outputLabel value="#{msg['dialog.notificationDialog.general.additionalPrints.use.text']}"
                           styleClass="bigFont"/>
            <p:selectBooleanCheckbox
                    value="#{notificationDialog.generalTab.useNotification}"
                    title="#{msg['dialog.notificationDialog.general.additionalPrints.use.info']}">
                <p:ajax event="change" process="@form" update="@form"/>
            </p:selectBooleanCheckbox>

            <!-- additional prints -->
            <h:outputLabel styleClass="bigFont"
                           value="#{msg['dialog.notificationDialog.general.additionalPrints.template.text']}"/>
            <p:selectOneMenu panelStyleClass="iconFixForSelectOneMenu"
                             title="#{msg['dialog.notificationDialog.general.additionalPrints.template.info']}"
                             disabled="#{!notificationDialog.generalTab.useNotification}"
                             value="#{notificationDialog.generalTab.selectedTemplate}"
                             converter="#{notificationDialog.generalTab.templatesTransformer}">

                <f:selectItem itemValue="#{null}"
                              itemLabel="#{msg['dialog.notificationDialog.general.additionalPrints.template.none']}"/>

                <f:selectItems
                        value="#{notificationDialog.generalTab.templates}"
                        var="template" itemLabel="#{template.name}" itemValue="#{template}"/>

                <p:ajax update="@this" event="change" process="@this"
                        partialSubmit="true"/>
            </p:selectOneMenu>

            <!-- print -->
            <h:outputLabel styleClass="bigFont"
                           value="#{msg['dialog.notificationDialog.general.additionalPrints.count.text']} "
                           title="#{msg['dialog.notificationDialog.general.additionalPrints.count.info']}"/>
            <p:spinner title="#{msg['dialog.notificationDialog.general.additionalPrints.count.info']}"
                       disabled="#{!notificationDialog.generalTab.useNotification}"
                       value="#{notificationDialog.generalTab.printCount}"
                       styleClass="oneNumberSpinner" min="0" max="9"/>
        </h:panelGrid>
    </p:outputPanel>

    <!-- navigation bar -->
    <histo:notificationDialogNavigationBar renderBack="false" renderContact="false"/>
</ui:composition>